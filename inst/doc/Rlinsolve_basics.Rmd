---
title: "Basics of Rlinsolve"
author: "Kisung You"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Rlinsolve_basics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{microbenchmark, optR, pcg}
---

## Rlinsolve

*Rlinsolve* is a collection of iterative solvers for (sparse) linear system of equations. It 
heavily relies on two popular packages, [RcppArmadillo](https://CRAN.R-project.org/package=RcppArmadillo) for speeding up computation and [Matrix]( https://CRAN.R-project.org/package=Matrix) for sparse matrix 
support.

## Solving **Ax=b** 
Introducing *RcppArmadillo* simply added computational boost. Let's check by comparing with some basic approaches by simulating *10000* x *500* system matrix for normal equation form.
```{r, message=F, warning=F}
library(microbenchmark)
library(pcg)
library(optR)
library(Rlinsolve)
```
```{r}
A = matrix(rnorm(10000*50),nrow=10000)
x = matrix(rnorm(50))
b = A%*%x
```



First example is to use a default `solve` function from R base.
```{r}
# for SOLVE in R base, it needs to be transformed into normal equation form.
Anormal = t(A)%*%A
bnormal = t(A)%*%b
microbenchmark(solve(Anormal,bnormal))
```

Let's compare other available packages(`pcg` and `optR`) and their computation time,
```{r}
microbenchmark(pcg(Anormal,bnormal),
               optR(A,b,method="gauss"),
               times=10)
```


Finally, let's test two functions in our package, *lsolve.bicgstab* and *lsolve.sor*,
```{r}
microbenchmark(lsolve.sor(A,b,verbose=FALSE),
               lsolve.bicgstab(A,b,verbose=FALSE),
               times=10)
```

where we can witness that our codes are definitely faster by at least several folds.

## Solving **Ax=b** with sparse A
We have an auxiliary function to generate sparse system matrix, `aux.fisch`, and let's make a
*100* x *100* sparse matrix, and corresponding system.
```{r}
Psparse = aux.fisch(10,sparse=TRUE) # sparse matrix
Pdense = aux.fisch(10,sparse=FALSE) # dense  matrix
x = matrix(rnorm(100))
b = Pdense %*% x
```

Again, we perform the test from previously used functions from other packages as well as functions in *Rdimtools* package,
```{r}
microbenchmark(solve(Pdense,b),
               optR(Pdense,b,method="gauss"),
               pcg(Pdense,b),
               times=10)
microbenchmark(lsolve.bicg(Psparse,b,verbose=FALSE),
               lsolve.cgs(Psparse,b,verbose=FALSE),
               lsolve.gs(Psparse,b,verbose=FALSE),
               lsolve.sor(Psparse,b,verbose=FALSE),
               times=10)
```

where in our case, supporting sparse matrices have shown much superior results. Note that the size has been set to be small since dense solvers are too slow to be manageably visible.
